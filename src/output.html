<!DOCTYPE html>
<html>
<head>
    <title>TITLE-APP</title>
    <link href="prism.css" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.3.3/semantic.css">
	<meta charset="utf-8"/>
</head>
<body>
<div class="ui container"><h1>app.js</h1><pre><code class="language-javascript">&#39;use strict&#39;;

// const readAllFilesCallback = require(&#39;./readdirp-callback&#39;);
const readAllFilesAPI = require(&#39;./readdirp-stream&#39;);
const processFiles = require(&#39;./processFiles&#39;);
const { settingsHTML } = require(&quot;./settingsHTML&quot;);

// 1. read filenames from the specified directory downwards,
// 2. push the filenames in an array,
// 3. execute the specified callback on the created array.
readAllFilesAPI(processFiles, settingsHTML.root);

</code></pre><h1>convertFileToHtml.js</h1><pre><code class="language-javascript">&#39;use strict&#39;;
var fs = require(&#39;fs&#39;);
var _ = require(&#39;lodash&#39;);

const { settingsHTML } = require(&quot;./settingsHTML&quot;);

/**
 * @param {string} filename the file (including path) to process
 * @returns {contents} parsed file contents
 * */
function convertFileToHtml(filename) {
    const openingCode = &quot;&lt;pre&gt;&lt;code class=&quot;;
    const postfix = &quot;&lt;/code&gt;&lt;/pre&gt;&quot;;
    var extension,
        prefix,
        fileTitle,
        convertedData,
        language,
        languages = {
            js: &quot;language-javascript&quot;,
            html: &quot;language-html&quot;,
            css: &quot;language-css&quot;,
            other: &quot;language-javascript&quot;
        };

    // &#39;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot;&gt;&#39;

    var data = fs.readFileSync(filename, &#39;utf8&#39;)
    extension = filename.split(&#39;.&#39;).pop();

    if (extension === &#39;html&#39; ||
        extension === &#39;js&#39; ||
        extension === &#39;ejs&#39;) {
        convertedData = _.escape(data);
    } else {
        convertedData = data;
    }

    fileTitle = `${settingsHTML.titleDecorationOpen}${filename}${settingsHTML.titleDecorationClose}`;
    language = languages[extension] ? languages[extension] : languages.other;
    prefix = `${openingCode}&quot;${language}&quot;&gt;`;

    convertedData = fileTitle + prefix + convertedData + postfix;

    return convertedData;
}

module.exports = convertFileToHtml;</code></pre><h1>footer.html</h1><pre><code class="language-html">&lt;script src=&quot;prism.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre><h1>header.html</h1><pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;TITLE-APP&lt;/title&gt;
    &lt;link href=&quot;prism.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;
	&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.3.3/semantic.css&quot;&gt;
	&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class=&quot;ui container&quot;&gt;</code></pre><h1>processFiles.1.js</h1><pre><code class="language-javascript">&#39;use strict&#39;;
const fs = require(&#39;fs&#39;);

const { settingsHTML } = require(&quot;./settingsHTML&quot;);


function processFiles(files) {

    fs.readFile(&#39;header.html&#39;, (err, header) =&gt; {
        if (err) throw err;
        let strHeader = header.toString(&#39;utf8&#39;).replace(&#39;TITLE-APP&#39;, settingsHTML.outputFilename);
        header = Buffer.from(strHeader, &#39;utf8&#39;);
        fs.writeFile(__dirname + `/${settingsHTML.outputFilename}.html`, header, { flag: &#39;w&#39; }, (err) =&gt; {
            if (err) throw err;
        });
    });
}

processFiles();</code></pre><h1>readdirp-callback.js</h1><pre><code class="language-javascript">&#39;use strict&#39;;
var readdirp = require(&#39;readdirp&#39;);

var settings = {
    root: &#39;./&#39;,          // &#39;./your-folder-path&#39;,
    entryType: &#39;all&#39;,
    fileFilter: [&#39;!*.json&#39;],
    directoryFilter: [&#39;!*.*&#39;, &#39;!.git&#39;, &#39;!*modules&#39;],
};

function readAllFilesCallback(myCallback) {
    // In this example, this variable will store all the paths of the files and directories inside the providen path
    var allFilePaths = [];

    // Iterate recursively through a folder
    readdirp(settings,
        // This callback is executed everytime a file or directory is found inside the providen path
        function (entry) {
            // Store the fullPath of the file/directory in our custom array 
            if (!entry.stat.isDirectory()) {
                allFilePaths.push(
                    entry.path
                );
            }
        },

        // This callback is executed once 
        function (err, res) {
            if (err) {
                throw err;
            }

            // An array with all the fileEntry objects of the folder 
            myCallback(allFilePaths);
        }
    );
}

module.exports = readAllFilesCallback;</code></pre><h1>processFiles.js</h1><pre><code class="language-javascript">&#39;use strict&#39;;
const fs = require(&#39;fs&#39;);

const convertFileToHtml = require(&#39;./convertFileToHtml&#39;);
const { settingsHTML } = require(&quot;./settingsHTML&quot;);

function processFiles(files) {
    if (files.length === 0) return;

    writeHeader();

    files.forEach((file) =&gt; {
        // ignore the output file.
        if (file !== settingsHTML.outputFilename) {
            let fileText = convertFileToHtml(file);
            let filepath = __dirname + &#39;\\&#39; + `${settingsHTML.outputFilename}`;
            fs.writeFileSync(filepath, fileText, { encoding: &#39;utf8&#39;, flag: &#39;a&#39; });
        }
    });

    writeFooter();
}

function writeHeader() {
    let header = fs.readFileSync(&#39;header.html&#39;, &#39;utf8&#39;);

    // let strHeader = header.toString(&#39;utf8&#39;).replace(&#39;TITLE-APP&#39;, settingsHTML.outputFilename);
    // header = Buffer.from(strHeader, &#39;utf8&#39;);
    header.replace(&#39;TITLE-APP&#39;, settingsHTML.outputFilename);
    let filepath = __dirname + &#39;\\&#39; + `${settingsHTML.outputFilename}`;
    fs.writeFileSync(filepath, header, { encoding: &#39;utf8&#39;, flag: &#39;w&#39; });
}

function writeFooter() {
    let footer = fs.readFileSync(&#39;footer.html&#39;, &#39;utf8&#39;);
    let filepath = __dirname + &#39;\\&#39; + `${settingsHTML.outputFilename}`;
    fs.writeFileSync(filepath, footer, { encoding: &#39;utf8&#39;, flag: &#39;a&#39; });
}

module.exports = processFiles;</code></pre><h1>readdirp-stream.js</h1><pre><code class="language-javascript">&#39;use strict&#39;;
const readdirp = require(&#39;readdirp&#39;);

var settingsAPI = {
    root: &#39;./&#39;,          // &#39;./your-folder-path&#39;,
    entryType: &#39;all&#39;,
    fileFilter: [&#39;!*.json&#39;, &#39;!*.&#39;, &#39;!TODO.&#39;, &#39;!*.md&#39;],
    directoryFilter: [&#39;!.git&#39;, &#39;!*modules&#39;],
};

function readAllFilesAPI(myCallback, root) {
    var allFilePaths = [];
    settingsAPI.root = root;

    // Iterate recursively through a folder
    readdirp(settingsAPI)
        // execute everytime a file is found in the providen directory
        .on(&#39;data&#39;, function (entry) {
            // Store the fullPath of the file/directory in our custom array
            if (!entry.stat.isDirectory()) {
                allFilePaths.push(
                    entry.path
                );
            }
        })
        .on(&#39;warn&#39;, function (warn) {
            console.log(&quot;Warn: &quot;, warn);
        })
        .on(&#39;error&#39;, function (err) {
            console.log(&quot;Error: &quot;, err);
        })
        .on(&#39;end&#39;, function () {
            myCallback(allFilePaths);
        });
}

module.exports = readAllFilesAPI;</code></pre><h1>settingsHTML.js</h1><pre><code class="language-javascript">// TODO: these settings to be incorporated to some sort of file?
var settingsHTML = {
    root: &#39;./&#39;,
    outputFilename: &#39;output.html&#39;,
    titleDecorationOpen: &#39;&lt;h1&gt;&#39;,
    titleDecorationClose: &#39;&lt;/h1&gt;&#39;,
    createTableOfContents: false
};
exports.settingsHTML = settingsHTML;</code></pre><h1>test-write.js</h1><pre><code class="language-javascript">const { settingsHTML } = require(&quot;./settingsHTML&quot;);
const fs = require(&#39;fs&#39;);

function writeFooter() {
    let footer = fs.readFileSync(&#39;footer.html&#39;);

    let filename = __dirname + `\\${settingsHTML.outputFilename}`
    fs.writeFile(filename, footer, { flag: &#39;a&#39; }, (err) =&gt; {
        if (err) throw err;
    });
}

function writeFile1() {
    let data = fs.readFileSync(&#39;processFiles.js&#39;);
    let filename = __dirname + `\\${settingsHTML.outputFilename}`
    fs.writeFileSync(filename, data, { flag: &#39;w&#39; });
};

writeFile1();
writeFooter();</code></pre><h1>reducers\reducer1.js</h1><pre><code class="language-javascript"></code></pre><h1>reducers\reducer2.js</h1><pre><code class="language-javascript"></code></pre><h1>tests\app-klaw.js</h1><pre><code class="language-javascript">const getFile = require(&#39;../convertFileToHtml&#39;);
const klawSync = require(&#39;klaw-sync&#39;);
const path = require(&#39;path&#39;);
const _ = require(&#39;lodash&#39;);

// get in object all files, exclude directories.
const files = klawSync(&#39;./&#39;, { nodir: true });

_.forEach(files, function (value, key) {
    var workPath = path.parse(value.path).dir;
    var workFile = path.parse(value.path).base;

    //  remove the path up to the current working directory.
    var newPath = workPath.replace(__dirname, &quot;&quot;);

    // add a new property to the object &lt;files&gt; with the file name.
    // if file in sub-directory add &quot;./sub-directory&quot; to filename.
    if (newPath) {
        value.filename = `${newPath}\\${workFile}`;
    } else {
        value.filename = workFile;
    }
});

_.forEach(files, function (value, key) {
    console.log(value.filename);
});




</code></pre><h1>tests\app-readdirp.js</h1><pre><code class="language-javascript">const readdirp = require(&#39;readdirp&#39;);

var settings = {
  root: &#39;./&#39;,          // &#39;./your-folder-path&#39;,
  entryType: &#39;all&#39;,
  fileFilter: [&#39;!*.json&#39;, &#39;!*.&#39;, &#39;!TODO.&#39;, &#39;!*.md&#39;],
  directoryFilter: [&#39;!.git&#39;, &#39;!*modules&#39;],
};

function readAllFiles(myCallback) {
    // In this example, this variable will store all the paths of the files and directories inside the providen path
    var allFilePaths = [];

    // Iterate recursively through a folder
    readdirp(settings,
        // This callback is executed everytime a file or directory is found inside the providen path
        function (entry) {

            // Store the fullPath of the file/directory in our custom array 
            if (!entry.stat.isDirectory()) {
                allFilePaths.push(
                    entry.path //+ &quot;---&quot; + entry.stat.isDirectory()
                );
            }
        },

        // This callback is executed once 
        function (err, res) {
            if (err) {
                throw err;
            }

            // An array with all the fileEntry objects of the folder 
            // console.log(allFilePaths);
            myCallback(allFilePaths);
        }
    );
}

readAllFiles(console.log);</code></pre><h1>tests\index.mjs</h1><pre><code class="language-javascript">// run it with: node --experimental-modules index.mjs

import { square, diag } from './lib.mjs';
console.log(square(11)); // 121
console.log(diag(4, 3)); // 5</code></pre><h1>tests\lib.mjs</h1><pre><code class="language-javascript">export const sqrt = Math.sqrt;
export function square(x) {
    return x * x;
}
export function diag(x, y) {
    return sqrt(square(x) + square(y));
}</code></pre><h1>components\component1.js</h1><pre><code class="language-javascript"></code></pre><h1>components\component2.js</h1><pre><code class="language-javascript"></code></pre><h1>components\component3.js</h1><pre><code class="language-javascript"></code></pre><script src="prism.js" type="text/javascript"></script>
</div>
</body>
</html>